<!DOCTYPE html>
<html>

<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <title>QR coder</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style type="text/css">
        .top {
            margin-top: 10rem;
        }
    </style>

    <script type="text/javascript">
        let isEnter = (event) => {
            if (event.code === 'Enter') {
                sendJSON()
            }
        }

        let sendJSON = () => {
            let input_text = document.querySelector('#input');
            let result = document.querySelector('.result');

            // Create a XHR object 
            let xhr = new XMLHttpRequest();
            let url = "/to_qrcode";

            // open a connection 
            xhr.open("POST", url, true);

            // Set the request header i.e. which type of content you are sending 
            xhr.setRequestHeader("Content-Type", "application/json");

            // Create a state change callback 
            xhr.onreadystatechange = () => {
                if (xhr.readyState === xhr.DONE && xhr.status === 200) {

                    // Print received data from server 
                    result.innerHTML = JSON.parse(xhr.responseText).svg;

                }
            };

            // Converting JSON data to string 
            var data = JSON.stringify({ "text": input_text.value });

            // Sending data with the request 
            xhr.send(data);
        }
    </script>
</head>

<body>
    <div class="container top">
        <h2>QR Coder</h2>
        <p>Paste the link or text you want to convert to a QR Code below</p>
    </div>

    <div class="container">
        <div class="form-group">
            <label for="inputArea">Paste your text here</label>
            <input type="text" onkeyup="isEnter" class="form-control" id="input" placeholder="Paste the link/text here."
                name="input" required>
        </div>
        <button onclick="sendJSON()" class="btn btn-primary">Generate</button>

        <div class="result"></div>
    </div>
</body>

</html>